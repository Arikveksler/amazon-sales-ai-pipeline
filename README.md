# Amazon Sales AI Pipeline

CrewAI-based pipeline for analyzing Amazon India sales data.
Analyst Crew cleans the raw data, Scientist Crew builds an ML model and generates evaluation reports.

## Project Structure

```
amazon-sales-ai-pipeline/
├── src/
│   ├── crews/
│   │   ├── analyst_crew/    # Data cleaning agent, tools & tasks
│   │   └── scientist_crew/  # ML modeling agent (TBD)
│   ├── flow/
│   │   ├── main_flow.py     # Pipeline orchestrator
│   │   ├── validators.py    # Validation between steps
│   │   └── state_manager.py # JSON-based run state
│   └── utils/
│       └── error_handler.py # Custom exceptions, retry, logging
├── data/
│   ├── raw/                 # Raw CSV files
│   ├── processed/           # Cleaned data
│   └── contracts/           # Dataset contract JSON
├── outputs/
│   ├── models/              # Trained model (.pkl)
│   └── reports/             # Evaluation & model card
├── logs/                    # Pipeline logs
└── tests/
```

## Crew 1 - Analyst Implementation

### Agent: Senior Data Analyst
The Analyst Crew contains a single agent - **Senior Data Analyst** - built with CrewAI.
This agent is responsible for analyzing the Amazon dataset, generating visualizations, and providing actionable business insights.

**Agent Configuration:**
- Model: `gpt-4o-mini`
- Memory: Enabled
- Delegation: Disabled

### Tool: EDA Tools (`src/tools/eda_tools.py`)
A custom CrewAI tool decorated with `@tool` that performs:

1. **Data Preprocessing:**
   - Cleans price columns (removes `₹` symbol and commas)
   - Converts prices from string to float (INR currency)
   - Extracts main category from nested category strings

2. **Visualization Generation:**
   - Price Distribution Histogram (with KDE)
   - Top 10 Categories Bar Chart
   - Price vs Rating Scatter Plot (with trend line)

3. **Statistical Summary:**
   - Returns detailed statistics for the agent to analyze
   - Includes price analysis, category distribution, rating insights, and discount analysis

### Outputs
| File | Description |
|------|-------------|
| `data/eda_report.html` | Interactive HTML report with embedded charts |
| `insights.md` | Markdown document with 3-5 business insights generated by the AI agent |

### Running the Analyst Crew
```bash
python main.py
```

## Installation

```bash
git clone https://github.com/Arikveksler/amazon-sales-ai-pipeline.git
cd amazon-sales-ai-pipeline
pip install -r requirements.txt
```

## Configuration

Create a `.env` file in the project root:

```
OPENAI_API_KEY=your-api-key-here
```

## Usage

```bash
python src/flow/main_flow.py
```

## Week 2: Feature Engineering

Transforms the raw Amazon dataset into a numerical `features.csv` file (12 columns, 1465 rows) ready for ML model training.

**Run the script:**
```bash
python src/tools/feature_engineering.py
```

**Run the tests:**
```bash
python -m unittest tests.test_feature_engineering -v
```

**Output:** `data/features/features.csv`

For a full description of every feature column (what it represents, how it's calculated, and its data type), see [docs/FEATURE_REGISTRY.md](docs/FEATURE_REGISTRY.md).

## Status

Pipeline infrastructure ready. Analyst Crew (Week 1) and Feature Engineering (Week 2) complete.

## Team

- **Pipeline Lead:** Arik Veksler
- **Analyst Crew:** TBD
- **Scientist Crew:** TBD
